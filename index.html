<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>SkyBuddy — Airline Chatbot</title>
  <meta name="color-scheme" content="light">
  <style>
    :root{
      --bg:#f6f8fc;
      --card:#ffffff;
      --text:#1b2540;
      --muted:#6b7a99;
      --brand:#3b82f6;          /* primary */
      --brand-2:#60a5fa;        /* accent */
      --border:#e5eaf3;
      --chip:#eef4ff;
      --shadow:0 10px 30px rgba(26, 35, 126, .08);
    }
    *{box-sizing:border-box}
    body{
      margin:0;background:var(--bg);color:var(--text);
      font:16px/1.45 system-ui, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
    }
    /* Header */
    header{
      position:sticky; top:0; z-index:10;
      background:linear-gradient(135deg,#e6f0ff, #f7fbff 50%, #ffffff);
      border-bottom:1px solid var(--border);
      padding:14px 18px; display:flex; align-items:center; gap:12px;
    }
    .logo{
      width:34px; height:34px; border-radius:50%;
      display:grid; place-items:center; color:#fff;
      background:linear-gradient(135deg,var(--brand),var(--brand-2));
      box-shadow:var(--shadow);
      position:relative; overflow:hidden;
    }
    .logo::after{           /* tiny moving plane trail */
      content:"";
      position:absolute; left:-24px; top:50%; width:24px; height:2px;
      background:rgba(255,255,255,.8); transform:translateY(-50%);
      animation:trail 2.2s linear infinite;
    }
    @keyframes trail{
      0%{left:-24px; opacity:0}
      20%{opacity:1}
      70%{opacity:1}
      100%{left:100%; opacity:0}
    }
    h1{font-size:18px; margin:0}
    .sub{font-size:13px; color:var(--muted)}

    /* App shell */
    .app{max-width:900px; margin:0 auto; display:flex; flex-direction:column; min-height:100dvh}
    .content{flex:1; display:flex; flex-direction:column; padding:18px}
    .chat{
      flex:1; background:var(--card); border:1px solid var(--border);
      border-radius:16px; padding:14px; overflow:auto; box-shadow:var(--shadow);
    }

    /* Message bubbles */
    .msg{display:flex; gap:10px; margin:10px 6px; align-items:flex-end}
    .msg.me{justify-content:flex-end}
    .bubble{
      max-width:72%; padding:12px 14px; border-radius:14px; box-shadow:0 4px 16px rgba(31,41,55,.06);
      animation:fadeSlide .25s ease both;
      white-space:pre-wrap; word-wrap:break-word;
      border:1px solid var(--border); background:#f9fbff;
    }
    .me .bubble{
      background:linear-gradient(135deg, #eaf2ff, #f5f9ff 70%, #ffffff);
      border:1px solid #dbe7ff;
    }
    .bot .bubble{
      background:#ffffff;
    }
    @keyframes fadeSlide{
      from{opacity:0; transform:translateY(6px)}
      to{opacity:1; transform:translateY(0)}
    }
    .meta{font-size:12px; color:var(--muted); margin:4px 6px 0 6px}
    .meta a{color:var(--brand); text-decoration:none}
    .meta a:hover{text-decoration:underline}

    /* Typing indicator */
    .typing{display:inline-flex; gap:6px; align-items:center}
    .dot{width:7px;height:7px;border-radius:50%; background:#b6c6ff; animation:blink 1.2s infinite ease-in-out}
    .dot:nth-child(2){animation-delay:.15s}
    .dot:nth-child(3){animation-delay:.3s}
    @keyframes blink{
      0%,80%,100%{opacity:.2; transform:translateY(0)}
      40%{opacity:1; transform:translateY(-3px)}
    }

    /* Suggestion chips */
    .chips{display:flex; flex-wrap:wrap; gap:8px; margin:12px 2px}
    .chip{
      background:var(--chip); color:#1f3b77; padding:8px 12px; border-radius:24px;
      border:1px solid #d7e5ff; cursor:pointer; user-select:none; transition:.15s transform;
    }
    .chip:hover{transform:translateY(-1px)}
    .chip:active{transform:translateY(0)}

    /* Input area */
    .composer{
      display:flex; gap:10px; padding:12px 0;
      position:sticky; bottom:0; background:var(--bg);
    }
    .composer .box{
      flex:1; background:var(--card); border:1px solid var(--border); border-radius:14px; padding:8px 10px; display:flex; gap:8px; align-items:center;
      box-shadow:var(--shadow);
    }
    input{
      flex:1; border:0; outline:none; background:transparent; font-size:16px; color:var(--text);
    }
    button{
      border:0; outline:none; padding:10px 14px; border-radius:12px; cursor:pointer; color:#fff;
      background:linear-gradient(135deg,var(--brand),var(--brand-2)); box-shadow:0 8px 20px rgba(59,130,246,.25);
      display:inline-flex; align-items:center; gap:8px; transition:.18s transform, .18s box-shadow;
    }
    button:hover{transform:translateY(-1px); box-shadow:0 10px 26px rgba(59,130,246,.30)}
    button:disabled{opacity:.6; cursor:not-allowed; transform:none; box-shadow:0 4px 14px rgba(0,0,0,.08)}
    .send-ico{display:inline-block; transform:translateY(1px)}
    .send-ico svg{display:block}

    /* Small screens */
    @media (max-width:640px){
      .bubble{max-width:85%}
      .chips{gap:6px}
      .chip{padding:7px 10px}
    }
  </style>
</head>
<body>
  <div class="app">
    <header>
      <div class="logo" aria-hidden="true">✈️</div>
      <div>
        <h1>SkyBuddy</h1>
        <div class="sub">Your friendly airline chatbot — ask about flights near a place, baggage rules, TSA liquids, and more.</div>
      </div>
    </header>

    <div class="content">
      <div id="chat" class="chat" aria-live="polite" aria-label="Chat history"></div>

      <div class="chips" id="chips">
        <div class="chip">Flights near LAX</div>
        <div class="chip">United baggage</div>
        <div class="chip">What’s the liquids rule?</div>
        <div class="chip">Can I carry 20000 mAh power bank?</div>
        <div class="chip">Airport in Tokyo</div>
      </div>

      <div class="composer">
        <div class="box">
          <input id="q" placeholder="Ask anything… e.g., ‘baggage for United’, ‘planes over New York’, ‘DFW’" autocomplete="off"/>
          <button id="send" type="button" aria-label="Send">
            <span class="send-ico">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
                <path d="M4 12l16-8-6.5 8L20 20 4 12z" fill="white"/>
              </svg>
            </span>
            Send
          </button>
        </div>
      </div>
    </div>
  </div>

  <script>
    // ========= CONFIG =========
    const API = "https://airline-bot-ry5f.onrender.com"; // <-- replace with https://airline-bot-ry5f.onrender.com

    // ========= DOM =========
    const elChat = document.getElementById("chat");
    const elInput = document.getElementById("q");
    const elSend = document.getElementById("send");
    const elChips = document.getElementById("chips");

    // ========= UI helpers =========
    function addMsg(role, text, source){
      const row = document.createElement("div");
      row.className = "msg " + (role === "me" ? "me" : "bot");

      const bubble = document.createElement("div");
      bubble.className = "bubble";
      bubble.textContent = text;

      row.appendChild(bubble);
      elChat.appendChild(row);

      if(source){
        const meta = document.createElement("div");
        meta.className = "meta";
        meta.innerHTML = `source: <a href="${source}" target="_blank" rel="noopener noreferrer">${source}</a>`;
        elChat.appendChild(meta);
      }

      elChat.scrollTop = elChat.scrollHeight;
    }

    function showTyping(){
      const row = document.createElement("div");
      row.className = "msg bot";
      row.id = "typing";
      const bubble = document.createElement("div");
      bubble.className = "bubble";
      bubble.innerHTML = `<span class="typing"><span class="dot"></span><span class="dot"></span><span class="dot"></span></span>`;
      row.appendChild(bubble);
      elChat.appendChild(row);
      elChat.scrollTop = elChat.scrollHeight;
    }
    function hideTyping(){
      const t = document.getElementById("typing");
      if(t) t.remove();
    }

    // ========= Chat logic =========
    async function ask(text){
      addMsg("me", text);
      elSend.disabled = true;
      showTyping();
      try{
        const r = await fetch(API + "/chat", {
          method: "POST",
          headers: {"Content-Type":"application/json"},
          body: JSON.stringify({message: text})
        });
        hideTyping();
        if(!r.ok){
          addMsg("bot", `Oops, server said ${r.status}. Try again.`);
          return;
        }
        const data = await r.json();
        addMsg("bot", data.answer || "(no answer)", data.source);
      }catch(err){
        hideTyping();
        addMsg("bot", "Network error. Please check your internet and try again.");
      }finally{
        elSend.disabled = false;
      }
    }

    // ========= Events =========
    elSend.addEventListener("click", () => {
      const t = elInput.value.trim();
      if(!t) return;
      elInput.value = "";
      ask(t);
    });
    elInput.addEventListener("keydown", (ev) => {
      if(ev.key === "Enter" && !ev.shiftKey){
        ev.preventDefault();
        elSend.click();
      }
    });
    elChips.addEventListener("click", (e) => {
      const chip = e.target.closest(".chip");
      if(!chip) return;
      ask(chip.textContent.trim());
    });

    // ========= Welcome =========
    addMsg("bot",
      "Hi, I’m SkyBuddy! ✈️\n"
      + "I can help with:\n"
      + "• Airline baggage rules (e.g., “United baggage”, “AA carry on size”)\n"
      + "• TSA liquids & power banks\n"
      + "• Live planes near a place (e.g., “flights near New York”)\n"
      + "• Airport info by code/name/city (e.g., “DFW”, “airport in Tokyo”)"
    );
  </script>
</body>
</html>
